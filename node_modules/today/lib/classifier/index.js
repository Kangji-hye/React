'use strict';

const path = require('path');
const natural = require('natural');
const classifier = new natural.BayesClassifier();

module.exports = {
    classify
};

// Add training data and train
//
require('glob').sync(path.join(__dirname, 'trainers/*.json')).forEach(tPath => {
    let category = path.basename(tPath, '.json');
    require(tPath).forEach(text => classifier.addDocument(text, category));
});

classifier.train();

// Execute a "null" match; this value is used to check for uncategorizable items
//
let noMatchValue = classifier.getClassifications('.')[0].value;

function classify(item) {
    let {label, value} = classifier.getClassifications(item)[0];

    if(+value === noMatchValue) {
        label = 'todo';
    }

    return label;
}